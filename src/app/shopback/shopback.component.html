<div class="container">
    <app-sidebar-back></app-sidebar-back>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">

    <div class="row header" style="text-align:center;color:green">
        <!-- Titre de votre tableau -->
    </div>

    <div class="container">
        <app-sidebar-back></app-sidebar-back>
        <link rel="stylesheet" href="https://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
    
        <div class="row header" style="text-align:center;color:green">
            <!-- Titre de votre tableau -->
        </div>
    
        <div class="container">
            <app-sidebar-back></app-sidebar-back>
            <link rel="stylesheet" href="https://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
            <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">
        
            <div class="row header" style="text-align:center;color:green">
                <!-- Titre de votre tableau -->
            </div>
        
            <div class="table-container">
                <!-- Barre de recherche et bouton de recherche -->
                <div class="row">
                    <div class="search-and-add">
                        <form class="form-inline ml-auto">
                            <div class="input-group">
                                <input class="form-control mr-sm-2" type="search" placeholder="Search By Name" aria-label="Search By Name"
                                    name="searchTerm" [(ngModel)]="searchTerm" (input)="onSearch()">
                                <span class="input-group-btn">
                                    <button class="btn btn-outline-success" type="submit">Search</button>
                                </span>
                            </div>
                            <button class="btn btn-success" type="button" [routerLink]="['/add']">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add New Product
                            </button>
                            <button class="btn btn-info" type="button" [routerLink]="['/stats']">
                                <span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Show Statistics
                            </button>
                        </form>
                    </div>
                </div>
            
                <!-- Tableau de produits avec pagination -->
                <table id="example" class="table table-striped table-bordered" style="width:90%">
                    <!-- En-tête du tableau -->
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Type</th>
                            <th>Date added</th>
                            <th>Description</th>
                            <th>Price</th>
                            <th>Stock Quantity</th>
                            <th style="width: 100px;">Action</th> <!-- Définir une largeur fixe pour la colonne "Action" -->
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Affichage des produits de la page actuelle -->
                        <tr *ngFor="let product of pagedProducts">
                            <td>{{ product.name }}</td>
                            <td>{{ product.type }}</td>
                            <td>{{ product.dateAdded }}</td>
                            <td>{{ product.description }}</td>
                            <td>${{ product.price }}</td>
                            <td>{{ product.stockQuantity }}</td>
                            <td>
                                <a class="btn btn-primary" [routerLink]="['/updateproduct', product.idProduct]">
                                    <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> <!-- Icône Bootstrap pour l'édition -->
                                </a>
                                <button class="btn btn-danger" (click)="removeProduct(product.idProduct)">
                                    <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> <!-- Icône Bootstrap pour la suppression -->
                                </button>
                                <button class="btn btn-info" (click)="openModal(product)">
                                    <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> <!-- Icône Bootstrap pour les détails -->
                                </button>
                                <button class="btn btn-warning" (click)="showDiscountInput(product)">
                                    <span class="glyphicon glyphicon-usd" aria-hidden="true"></span> 
                                </button>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <!-- Pagination -->
                        <tr>
                            <td colspan="7">
                                <ul class="pagination">
                                    <li class="page-item" *ngFor="let page of pages" [class.active]="page === currentPage">
                                        <a class="page-link" (click)="setPage(page)">{{ page }}</a>
                                    </li>
                                </ul>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            
                <!-- Modale -->
                <div class="custom-modal" tabindex="-1" role="dialog" *ngIf="showModal">
                    <div class="custom-modal-dialog" role="document">
                        <div class="custom-modal-content">
                            <div class="custom-modal-header bg-primary text-white">
                                <h5 class="custom-modal-title"></h5>
                                <button type="button" class="close" aria-label="Close" (click)="closeModal()">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="custom-modal-body">
                                <img *ngIf="!discountMode" [src]="getImageUrl(selectedProduct)" class="img-fluid" alt="Product Image">
                                <div *ngIf="discountMode">
                                    <p class="text-center discount-phrase">Enter the percentage discount you wish to apply to this product</p>
                                    <input type="number" [(ngModel)]="discountPercentage" placeholder="Enter discount %">
                                    <button class="btn btn-success rounded-circle" (click)="applyDiscount(selectedProduct)">Apply</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>